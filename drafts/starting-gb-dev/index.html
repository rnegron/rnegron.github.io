<!DOCTYPE html>
<html lang="en">
  <head>
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
    <link rel="shortcut icon" type="image/x-icon" href="favicon.ico" />

    <title>Raúl Negrón's Website</title>

    <meta charset="utf-8" />
    <link href="http://raulnegron.me/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Raúl Negrón's Website Full Atom Feed" />
    <link href="http://raulnegron.me/feeds/blog.atom.xml" type="application/atom+xml" rel="alternate" title="Raúl Negrón's Website Categories Atom Feed" />
    <link rel="stylesheet" href="http://raulnegron.me/theme/css/poole.css"/>
    <link rel="stylesheet" href="http://raulnegron.me/theme/css/syntax.css"/>
    <link rel="stylesheet" href="http://raulnegron.me/theme/css/lanyon.css"/>
    <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=PT+Serif:400,400italic,700%7CPT+Sans:400">
    <link rel="stylesheet" href="http://raulnegron.me/theme/css/styles.css"/>



    <meta name="tags" contents="gb" />
    <meta name="tags" contents="programming" />
    <meta name="tags" contents="mac" />
    <meta name="tags" contents="c" />
    <meta name="tags" contents="assembly" />

  </head>

  <body>
<!-- Target for toggling the sidebar `.sidebar-checkbox` is for regular
styles, `#sidebar-checkbox` for behavior. -->
<input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox">
<!-- Toggleable sidebar -->
<div class="sidebar" id="sidebar">
  <div class="sidebar-item">
    <div class="profile">
      <img src="http://raulnegron.me/theme/img/profile.png"/>
    </div>
  </div>

  <nav class="sidebar-nav">
  <a class="sidebar-nav-item" href="http://raulnegron.me/">main page</a>
      <a class="sidebar-nav-item" href="http://raulnegron.me/about">about&nbsp;me</a>
      <a class="sidebar-nav-item" href="http://raulnegron.me/reading">reading&nbsp;list</a>

      <a class="sidebar-nav-item" href="http://raulnegron.me/blog.html">blog</a>


  <a class="sidebar-nav-item" href="https://github.com/rnegron" target="_blank">github</a>
  <a class="sidebar-nav-item" href="https://www.linkedin.com/in/raulnegron/" target="_blank">linkedin</a>
  </nav>

  <div class="sidebar-item">
    <p>Site written in <a href="https://daringfireball.net/projects/markdown/">Markdown</a>, generated by <a href="http://docs.getpelican.com/en/stable/">Pelican</a>, hosted on <a href="https://pages.github.com/">Github Pages</a> and registered using <a href="https://aws.amazon.com/route53/">Route 53</a>.</p>
    <p class="tiny-note">
      <a class="muted" href="https://github.com/thomaswilley/pelicanyan">theme: modified pelicanyan v0.1</a>
    </p>
  </div>
</div>    <div class="wrap">
      <div class="masthead">
        <div class="container">
          <h3 class="masthead-title">
            <a href="http://raulnegron.me/" title="Home">Raúl Negrón's Website</a>
          </h3>
        </div>
      </div>

      <div class="container content">
<div class="posts">
<div class="post">
    <h1 class="post-title">
      Getting started with Game Boy development on&nbsp;Mac
    </h1>
    <span class="post-date">April 19, 2018</span>

    <p><br>
<center>
<img src="http://raulnegron.me/images/gameboy.png" style="width: 170px;"/>
</center>
<br></p>
<p>I don&#8217;t know what inspired it, but recently I got the idea that programming for an old game console would make for a fun project. Apart from giving me an excuse to write code in a language other than Python, it&#8217;s something I&#8217;ve wanted to do ever since I learned that programming was at the heart of all the great games I&#8217;ve played throughout the years. So, I decided to find out how feasible it would be to program for one of these old school gaming&nbsp;systems.</p>
<p>The Game Boy Advance was my first research subject. While reading up on the <span class="caps">GBA</span>, I learned that the original Game Boy (model &#8220;<span class="caps">DMG</span>-01&#8221;) had a more well-established homebrew community, compared to the Game Boy Advance. There is a lot of great documentation out there on developing for the Game Boy! Just visiting the <a href="https://github.com/avivace/awesome-gbdev">awesome-gbdev</a> repo convinced me to choose the original Game Boy as my retro coding&nbsp;platform.</p>
<p>I&#8217;d like to blog about my experience as a form of self-motivation. I&#8217;ll write about the process from the start and then be able to look back and see how I&#8217;ve progressed along the way! And if someone happens upon these posts, I hope they find them&nbsp;useful.</p>
<h1>A list of useful links and&nbsp;sources</h1>
<p>Having already mentioned the place to get the most useful resources (<a href="https://github.com/avivace/awesome-gbdev">awesome-gbdev</a>), I&#8217;ll go ahead and highlight a few resources which are not (yet) on that&nbsp;list.</p>
<ul>
<li>
<p><a href="https://www.gamasutra.com/blogs/DoctorLudos/20171207/311143/Making_a_Game_Boy_game_in_2017_A_quotSheep_It_Upquot_PostMortem_part_12.php">Making a Game Boy game in 2017: A &#8220;Sheep It Up!&#8221; Post-Mortem&#8221;</a> -  A great read chronicling the development of a Game Boy game which introduces plenty of helpful concepts along the&nbsp;way</p>
</li>
<li>
<p><a href="https://qiita.com/syano/items/2180da2cfe9ce161e65b">開発環境の導入</a> - The blog post which inspired this one! I&#8217;ll be using it as a&nbsp;template.</p>
</li>
</ul>
<h1>Development Environment on&nbsp;MacOS</h1>
<p>As the title says, I am working towards a functional <span class="caps">GB</span> dev environment on MacOS (specifically High Sierra, version 10.13.4). Sadly, the best tools for Game Boy development are Windows-only. But that&#8217;s okay! We can get away with using <a href="https://www.winehq.org/">Wine</a> to run the best of&nbsp;them.</p>
<h2>Prerequisites</h2>
<p>The setup assumes the following software packages are already&nbsp;installed.</p>
<ul>
<li>brew</li>
<li>git</li>
<li>wine</li>
</ul>
<h2>An introduction to the&nbsp;tools</h2>
<p>The development scene for the Game Boy is centered around two programming languages: C and assembly. My personal preference was to start developing in C. I&#8217;m using Harry Mulder&#8217;s <a href="http://www.devrs.com/gb/hmgd/gbtd.html">Tile Designer</a> as well as his <a href="http://www.devrs.com/gb/hmgd/gbmb.html">Map Builder</a> to manage the graphical aspects of developing for a video game console. Finally, the <a href="http://bgb.bircd.org/">bgb</a> Game Boy emulator is the standard for testing and debugging Game Boy&nbsp;games.</p>
<h1>Getting a C compiler up and&nbsp;running:</h1>
<p>The tool of choice here is the <a href="http://gbdk.sourceforge.net/">Game Boy Developers Kit</a> (<span class="caps">GBDK</span>). The installation may be tricky on MacOS. There are a couple of alternative installation methods around, but I went for the&nbsp;following:</p>
<div class="highlight"><pre><span></span>$ git clone https://github.com/x43x61x69/gbdk-osx
$ <span class="nb">cd</span> gbdk-osx
$ mkdir -p sdcc/bin
$ sed -i <span class="s1">&#39;&#39;</span> -e <span class="s1">&#39;1005d&#39;</span> sdcc/src/SDCC.y
$ make
$ sudo cp -r gbdk-osx /opt/gbdk
</pre></div>


<p><code>make</code> will proceed to build <span class="caps">GBDK</span>. Note that the above commands do some extra stuff besides building the compiler libraries. Click on them below to learn more about what they are&nbsp;required.</p>
<p><a href="https://github.com/co-me/gbdk/issues/1"><code>mkdir -p sdcc/bin</code></a></p>
<p><a href="https://github.com/x43x61x69/gbdk-osx/issues/2"><code>sed -i '' -e '1005d' sdcc/src/SDCC.y</code></a></p>
<p><a href="https://github.com/co-me/gbdk/issues/5"><code>sudo cp -r gbdk-osx/build/ppc-unknown-linux2.2/gbdk /opt/gbdk</code></a></p>
<p>Make sure to add the path to the new binaries to your <code>PATH</code>:</p>
<div class="highlight"><pre><span></span><span class="nb">export</span> <span class="nv">PATH</span><span class="o">=</span><span class="s2">&quot;/opt/gbdk/bin:</span><span class="nv">$PATH</span><span class="s2">&quot;</span>
</pre></div>


<p>Ideally, you would include that line in your <code>.bash_profile</code> or similar. The compiler&#8217;s front-end (called <code>lcc</code>) would then be easily&nbsp;accessible.</p>
<p>You could also choose to leave the binaries in-place and make a symlink, like&nbsp;so:</p>
<div class="highlight"><pre><span></span>$ sudo ln -s build/ppc-unknown-linux2.2/gbdk /opt
</pre></div>


<p>In that case, you would have to adjust your <code>PATH</code> accordingly.</p>
<h1>Building a minimal Game Boy game: a sanity&nbsp;check</h1>
<!&#8212; GBDK came with an examples folder. Let&#8217;s build some Game Boy games! We can then emulate them using *bgb*.

<!&#8212; &#8220;`bash
cd /opt/gbdk/examples/gb &#8212;>

<p><span class="dquo">&#8220;</span>`&nbsp;&#8212;&gt;</p>
<p>Create a file and then copy-paste (or write by hand!) the following&nbsp;code:</p>
<div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;  // printf()</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;gb/gb.h&gt;  // joypad(), delay(), J_UP, J_DOWN, ...</span><span class="cp"></span>

<span class="kt">void</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>

    <span class="c1">// Loop forever</span>
    <span class="k">while</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>

        <span class="c1">// Check the status of the Game Boy Joy Pad</span>
        <span class="k">switch</span><span class="p">(</span><span class="n">joypad</span><span class="p">())</span> <span class="p">{</span>

            <span class="c1">// If the UP button is pressed...</span>
            <span class="k">case</span> <span class="nl">J_UP</span><span class="p">:</span>

                <span class="c1">// Display &quot;Up!&quot; on the screen</span>
                <span class="n">printf</span><span class="p">(</span><span class="s">&quot;Up!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>

                <span class="c1">// Then wait for half a second...</span>
                <span class="n">delay</span><span class="p">(</span><span class="mi">500</span><span class="p">);</span>

                <span class="c1">// Go back to checking the status of the Joy Pad</span>
                <span class="k">break</span><span class="p">;</span>

            <span class="c1">// And so on</span>
            <span class="k">case</span> <span class="nl">J_DOWN</span><span class="p">:</span>
                <span class="n">printf</span><span class="p">(</span><span class="s">&quot;Down!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
                <span class="n">delay</span><span class="p">(</span><span class="mi">500</span><span class="p">);</span>
                <span class="k">break</span><span class="p">;</span>

            <span class="k">case</span> <span class="nl">J_LEFT</span><span class="p">:</span>
                <span class="n">printf</span><span class="p">(</span><span class="s">&quot;Left!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
                <span class="n">delay</span><span class="p">(</span><span class="mi">500</span><span class="p">);</span>
                <span class="k">break</span><span class="p">;</span>

            <span class="k">case</span> <span class="nl">J_RIGHT</span><span class="p">:</span>
                <span class="n">printf</span><span class="p">(</span><span class="s">&quot;Right!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
                <span class="n">delay</span><span class="p">(</span><span class="mi">500</span><span class="p">);</span>
                <span class="k">break</span><span class="p">;</span>

            <span class="k">default</span><span class="o">:</span>
                <span class="k">break</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>


<p>Save the file as <code>first.c</code>. And&nbsp;now&#8230;</p>
<div class="highlight"><pre><span></span>$ lcc first.c -o first.gb
</pre></div>


<p>Hopefully everything compiled correctly! You&#8217;ll know because <code>lcc</code> stayed silent after it did its&nbsp;job.</p>
<p>Let&#8217;s run <em>bgb</em>, open <code>first.gb</code> and check out the&nbsp;results!</p>
<p><br>
<center>
<img src="http://raulnegron.me/images/gb-1-bgb-1.png" style="width: 250px;"/>
</center>
<br></p>
<p>And that&#8217;s it! From code to binary that the Game Boy&nbsp;recognizes.</p>
<h2>The C alternative: <span class="caps">RGBDS</span> on&nbsp;MacOS</h2>
<p>For coding in assembly, there is the <a href="https://github.com/rednex/rgbds">Rednex Game Boy Development System (<span class="caps">RGBDS</span>)</a>.
Installation couldn&#8217;t be&nbsp;simpler.</p>
<div class="highlight"><pre><span></span>brew install rgbds
</pre></div>


<p>I will definitely get into assembly on the <span class="caps">GB</span> at some point in the&nbsp;future!</p>
<h1>Further&nbsp;reading</h1>
<p>&#8230;</p>
  </div>
</div>
      </div>

      <label for="sidebar-checkbox" class="sidebar-toggle"></label>

      <script>
        (function(document) {
          var i = 0;
          // snip empty header rows since markdown can't
          var rows = document.querySelectorAll('tr');
          for(i=0; i<rows.length; i++) {
            var ths = rows[i].querySelectorAll('th');
            var rowlen = rows[i].children.length;
            if (ths.length > 0 && ths.length === rowlen) {
              rows[i].remove();
            }
          }
        })(document);
      </script>

      <script>
        /* Lanyon & Poole are Copyright (c) 2014 Mark Otto. Adapted to Pelican 20141223 and extended a bit by @thomaswilley */
        (function(document) {
          var toggle = document.querySelector('.sidebar-toggle');
          var sidebar = document.querySelector('#sidebar');
          var checkbox = document.querySelector('#sidebar-checkbox');
          document.addEventListener('click', function(e) {
            var target = e.target;
            if(!checkbox.checked ||
            sidebar.contains(target) ||
            (target === checkbox || target === toggle)) return;
            checkbox.checked = false;
            }, false);
            })(document);
      </script>
     </div>
  </body>
</html>