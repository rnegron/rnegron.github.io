<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-118286402-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-118286402-1');
  </script>

      <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
    <link rel="shortcut icon" type="image/x-icon" href="favicon.ico" />

    <title>Raúl Negrón's Website</title>

    <meta charset="utf-8" />
    <link href="https://raulnegron.me/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Raúl Negrón's Website Full Atom Feed" />

    <link rel="canonical" href="https://raulnegron.me/blog/2019/server-side-javascript-flavors"/>

    <link rel="stylesheet" href="https://raulnegron.me/theme/css/poole.css"/>
    <link rel="stylesheet" href="https://raulnegron.me/theme/css/syntax.css"/>
    <link rel="stylesheet" href="https://raulnegron.me/theme/css/lanyon.css"/>
    <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=PT+Serif:400,400italic,700%7CPT+Sans:400">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Oswald">
    <link rel="stylesheet" href="https://raulnegron.me/theme/css/styles.css"/>



    <meta name="tags" contents="javascript" />
    <meta name="tags" contents="node" />
    <meta name="tags" contents="express" />
    <meta name="tags" contents="js" />
    <meta name="tags" contents="backend" />
    <meta name="tags" contents="programming" />

  </head>

  <body>
<!-- Target for toggling the sidebar `.sidebar-checkbox` is for regular
styles, `#sidebar-checkbox` for behavior. -->
<input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox">
<!-- Toggleable sidebar -->
<div class="sidebar" id="sidebar">
  <div class="sidebar-item">
    <div class="profile">
      <img src="https://raulnegron.me/theme/img/profile.png"/>
    </div>
  </div>

  <nav class="sidebar-nav">
  <a class="sidebar-nav-item" href="https://raulnegron.me/">main page</a>
      <a class="sidebar-nav-item" href="https://raulnegron.me/about">about&nbsp;me</a>
      <a class="sidebar-nav-item" href="https://raulnegron.me/reading">reading&nbsp;list</a>

      <a class="sidebar-nav-item" href="https://raulnegron.me/blog.html">blog</a>


  <a class="sidebar-nav-item" href="https://github.com/rnegron" target="_blank">github</a>
  <a class="sidebar-nav-item" href="https://www.linkedin.com/in/raulnegron/" target="_blank">linkedin</a>
  </nav>

  <div class="sidebar-item">
    <p>Site written in <a href="https://daringfireball.net/projects/markdown/">Markdown</a>, generated by <a href="http://docs.getpelican.com/en/stable/">Pelican</a>, hosted on <a href="https://pages.github.com/">Github Pages</a> and registered using <a href="https://aws.amazon.com/route53/">Route 53</a>.</p>
    <p class="tiny-note">
      <a class="muted" href="https://github.com/thomaswilley/pelicanyan">theme: modified pelicanyan v0.1</a>
    </p>
  </div>
</div>    <div class="wrap">
      <div class="masthead">
        <div class="container">
          <h3 class="masthead-title">
            <a href="https://raulnegron.me/" title="Home">Raúl Negrón's Website</a>
          </h3>
        </div>
      </div>

      <div class="container content">
<div class="posts">
<div class="post">
    <h1 class="post-title">
      Server-side JavaScript, available in 6&nbsp;flavors
    </h1>
    <span class="post-date">January 26, 2019</span>

    <p>I&#8217;ve been reading up on JavaScript these past few months. I feel like there used to be a stigma against the language during my time at university, and maybe there still is. I dug up and read a book I once bought called <a href="http://shop.oreilly.com/product/9780596517748.do">JavaScript: The Good Parts</a> by Douglas Crockford. It&#8217;s outdated now, but I used to joke that if &#8220;The Good Parts&#8221; could be described in 172 pages&#8230; Well, suffice it to say, I was not very&nbsp;encouraged.</p>
<p>Well, I&#8217;ve come around. <a href="https://github.com/mbeaudru/modern-js-cheatsheet">Modern JavaScript</a> is fun to write and, being a web-first language, it entices you to think about problems in a different way from other languages I&#8217;ve tried. After going through some <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/A_re-introduction_to_JavaScript">basic language training</a>, it&#8217;s time to see how to set up a simple web server, JavaScript&nbsp;style.</p>
<h2>A selection of flavors to choose&nbsp;from</h2>
<p>Once you start researching your options, you may feel the onset of analysis paralysis. There are a lot of different packages and projects to choose from. I thought it would be fun to write a simple echo server using a few of them, as an excuse to go through their tutorial and&nbsp;docs.</p>
<h2>Setup</h2>
<p>Simple as pie. For sending requests, I like to use <a href="https://httpie.org/">HTTPie</a>. We&#8217;ll use it to easily send some query parameters through <code>localhost</code> on port 3000. I should mention that I am running NodeJS v11.7.0 and HTTPie&nbsp;v1.0.2.</p>
<h2>1) NodeJS&nbsp;Core</h2>
<p>First up, vanilla <a href="https://nodejs.org/">NodeJS</a>&nbsp;style.</p>
<div class="highlight"><pre><span></span><span class="kr">const</span> <span class="nx">http</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;http&quot;</span><span class="p">);</span>
<span class="kr">const</span> <span class="nx">url</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;url&quot;</span><span class="p">);</span>

<span class="kr">const</span> <span class="nx">PORT</span> <span class="o">=</span> <span class="mi">3000</span><span class="p">;</span>

<span class="kr">const</span> <span class="nx">server</span> <span class="o">=</span> <span class="nx">http</span><span class="p">.</span><span class="nx">createServer</span><span class="p">((</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="nx">res</span><span class="p">.</span><span class="nx">writeHead</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="p">{</span> <span class="s2">&quot;content-type&quot;</span><span class="o">:</span> <span class="s2">&quot;application/json&quot;</span> <span class="p">});</span>

  <span class="kr">const</span> <span class="nx">query</span> <span class="o">=</span> <span class="nx">url</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">req</span><span class="p">.</span><span class="nx">url</span><span class="p">,</span> <span class="p">(</span><span class="nx">parseQueryString</span> <span class="o">=</span> <span class="kc">true</span><span class="p">)).</span><span class="nx">query</span><span class="p">;</span>

  <span class="nx">res</span><span class="p">.</span><span class="nx">end</span><span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">query</span><span class="p">));</span>
<span class="p">});</span>

<span class="nx">server</span><span class="p">.</span><span class="nx">listen</span><span class="p">(</span><span class="nx">PORT</span><span class="p">,</span> <span class="nx">err</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="k">throw</span> <span class="nx">err</span><span class="p">;</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="sb">`Now listening at port </span><span class="si">${</span><span class="nx">PORT</span><span class="si">}</span><span class="sb">...`</span><span class="p">);</span>
<span class="p">});</span>
</pre></div>


<p>Testing it out with <code>http :3000 user==1</code>, we get the following&nbsp;response:</p>
<div class="highlight"><pre><span></span>HTTP/1.1 <span class="m">200</span> OK
Connection: keep-alive
Content-Type: application/json
Date: Sat, <span class="m">26</span> Jan <span class="m">2019</span> <span class="m">22</span>:49:34 GMT
Transfer-Encoding: chunked

<span class="o">{</span>
    <span class="s2">&quot;user&quot;</span>: <span class="s2">&quot;1&quot;</span>
<span class="o">}</span>
</pre></div>


<p>A nifty, if plain, echo server. We should expect the response from all the servers in this blog post to have the <code>content-type</code> header set to &#8220;application/json&#8221; and the status set at 200, so I will omit the rest of their&nbsp;responses.</p>
<p>Even though the code is quite simple, we still had to work for that echo response. Other packages highlighted in this post will automatically parse the query string from the <span class="caps">URL</span>, but we didn&#8217;t have that luxury here. The response also had to be manually <span class="caps">JSON</span>-stringified. Diving a bit deeper (down the prototype chain), we find that our server, from <code>http.createServer()</code>, is an <a href="https://nodejs.org/api/events.html#events_class_eventemitter">EventEmitter</a>. It&#8217;s been instructed to listen for request events at port 3000. The <code>req</code> and <code>res</code> streams (notice there are two&#8230;) represent the client side request and the server side response, respectively. Moving on to the rest of the server-side&nbsp;flavors&#8230;</p>
<h2>2) NodeJS Core: The&nbsp;Sequel</h2>
<p>But before that, did you know there is a core NodeJS module called <a href="https://nodejs.org/api/http2.html">http2</a>? Actually, back it up, did you know there is a <a href="https://tools.ietf.org/html/rfc7540">version 2 of <span class="caps">HTTP</span></a>?! In any case, this module is a stable part of NodeJS now, so I believe it should get it&#8217;s own&nbsp;spot.</p>
<div class="highlight"><pre><span></span><span class="kr">const</span> <span class="nx">http2</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;http2&quot;</span><span class="p">);</span>
<span class="kr">const</span> <span class="nx">server</span> <span class="o">=</span> <span class="nx">http2</span><span class="p">.</span><span class="nx">createServer</span><span class="p">();</span>
<span class="kr">const</span> <span class="nx">url</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;url&quot;</span><span class="p">);</span>

<span class="kr">const</span> <span class="nx">PORT</span> <span class="o">=</span> <span class="mi">3000</span><span class="p">;</span>

<span class="nx">server</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">&quot;error&quot;</span><span class="p">,</span> <span class="nx">err</span> <span class="p">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">err</span><span class="p">));</span>

<span class="nx">server</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">&quot;stream&quot;</span><span class="p">,</span> <span class="p">(</span><span class="nx">stream</span><span class="p">,</span> <span class="nx">headers</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="kr">const</span> <span class="nx">response</span> <span class="o">=</span> <span class="nx">url</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">headers</span><span class="p">[</span><span class="s2">&quot;:path&quot;</span><span class="p">],</span> <span class="kc">true</span><span class="p">).</span><span class="nx">query</span><span class="p">;</span>

  <span class="nx">stream</span><span class="p">.</span><span class="nx">respond</span><span class="p">({</span> <span class="s2">&quot;:status&quot;</span><span class="o">:</span> <span class="mi">200</span><span class="p">,</span> <span class="s2">&quot;content-type&quot;</span><span class="o">:</span> <span class="s2">&quot;application/json&quot;</span> <span class="p">});</span>

  <span class="nx">stream</span><span class="p">.</span><span class="nx">end</span><span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">response</span><span class="p">));</span>
<span class="p">});</span>

<span class="nx">server</span><span class="p">.</span><span class="nx">listen</span><span class="p">(</span><span class="nx">PORT</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="sb">`HTTP2 Server now listening at port </span><span class="si">${</span><span class="nx">PORT</span><span class="si">}</span><span class="sb">...`</span><span class="p">);</span>
</pre></div>


<p>We&#8217;re in it now. Instead of two separate streams, the server now responds to the <code>stream</code> event and provides a duplex stream. We obtain the query parameters via the <code>headers</code> object, and parse it similarly to how it was done using the original <code>http</code> example.</p>
<p>By the way, the above code won&#8217;t work on browsers&#8230; While <span class="caps">HTTP</span>/2 <a href="https://http2.github.io/faq/#does-http2-require-encryption">does not</a> enforce encryption, modern browsers seem to have conspired to enforce it. There exists an <code>http2.createSecureServer</code> which can work with browsers. But without setting up a secure server, how will we (taste) test this flavor? Even HTTPie has trouble with it! I tried the experimental <a href="https://github.com/httpie/httpie-http2"><span class="caps">HTTP</span>/2</a> plugin, but could not get it to&nbsp;work.</p>
<p>Let&#8217;s roll up our sleeves and write a basic <span class="caps">HTTP</span>/2 client in Node to get this example to&nbsp;work.</p>
<div class="highlight"><pre><span></span><span class="kr">const</span> <span class="nx">http2</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;http2&quot;</span><span class="p">);</span>
<span class="kr">const</span> <span class="nx">PORT</span> <span class="o">=</span> <span class="mi">3000</span><span class="p">;</span>

<span class="kr">const</span> <span class="nx">client</span> <span class="o">=</span> <span class="nx">http2</span><span class="p">.</span><span class="nx">connect</span><span class="p">(</span><span class="sb">`http://localhost:</span><span class="si">${</span><span class="nx">PORT</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>

<span class="nx">client</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">&quot;error&quot;</span><span class="p">,</span> <span class="nx">err</span> <span class="p">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">err</span><span class="p">));</span>

<span class="kr">const</span> <span class="nx">req</span> <span class="o">=</span> <span class="nx">client</span><span class="p">.</span><span class="nx">request</span><span class="p">({</span>
  <span class="s2">&quot;:path&quot;</span><span class="o">:</span> <span class="s2">&quot;/?user=1&quot;</span>
<span class="p">});</span>

<span class="nx">req</span><span class="p">.</span><span class="nx">setEncoding</span><span class="p">(</span><span class="s2">&quot;utf8&quot;</span><span class="p">);</span>

<span class="kd">let</span> <span class="nx">data</span> <span class="o">=</span> <span class="p">[];</span>

<span class="nx">req</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">&quot;data&quot;</span><span class="p">,</span> <span class="nx">chunk</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="nx">data</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">chunk</span><span class="p">);</span>
<span class="p">});</span>

<span class="nx">req</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">&quot;end&quot;</span><span class="p">,</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">join</span><span class="p">());</span>
  <span class="nx">client</span><span class="p">.</span><span class="nx">close</span><span class="p">();</span>
<span class="p">});</span>

<span class="nx">req</span><span class="p">.</span><span class="nx">end</span><span class="p">();</span>
</pre></div>


<p>It works! This flavor we really had to work for, but it was worth it in the&nbsp;end.</p>
<p>(<span class="caps">P.S.</span> If you noticed the colon to the left of <code>"path"</code> and <code>"status"</code> in the code and don&#8217;t know what they are, may I introduce you to: <a href="https://http2.github.io/http2-spec/#rfc.section.8.1.2.1">pseudo headers</a>)</p>
<h2>3)&nbsp;Express</h2>
<p>Here we have the <a href="https://expressjs.com/">Express</a> framework, probably the most popular of the NodeJS backend&nbsp;libraries.</p>
<div class="highlight"><pre><span></span><span class="kr">const</span> <span class="nx">express</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;express&quot;</span><span class="p">);</span>
<span class="kr">const</span> <span class="nx">app</span> <span class="o">=</span> <span class="nx">express</span><span class="p">();</span>
<span class="kr">const</span> <span class="nx">PORT</span> <span class="o">=</span> <span class="mi">3000</span><span class="p">;</span>

<span class="nx">app</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">,</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="nx">res</span><span class="p">.</span><span class="nx">json</span><span class="p">(</span><span class="nx">req</span><span class="p">.</span><span class="nx">query</span><span class="p">);</span>
<span class="p">});</span>

<span class="nx">app</span><span class="p">.</span><span class="nx">listen</span><span class="p">(</span><span class="nx">PORT</span><span class="p">,</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="sb">`Express listening on port </span><span class="si">${</span><span class="nx">PORT</span><span class="si">}</span><span class="sb">...`</span><span class="p">)</span>
<span class="p">});</span>
</pre></div>


<p>That <code>app</code> object has access to a lot more than what is seen here, including a powerful method chaining concept called <a href="https://expressjs.com/en/guide/using-middleware.html">middleware</a>.</p>
<h2>4)&nbsp;Hapi.js</h2>
<p>I had never heard about Hapi before researching this topic. Here&#8217;s how it&nbsp;looks.</p>
<div class="highlight"><pre><span></span><span class="kr">const</span> <span class="nx">hapi</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;hapi&quot;</span><span class="p">);</span>
<span class="kr">const</span> <span class="nx">PORT</span> <span class="o">=</span> <span class="mi">3000</span><span class="p">;</span>

<span class="kr">const</span> <span class="nx">server</span> <span class="o">=</span> <span class="nx">hapi</span><span class="p">.</span><span class="nx">server</span><span class="p">({</span>
  <span class="nx">host</span><span class="o">:</span> <span class="s2">&quot;localhost&quot;</span><span class="p">,</span>
  <span class="nx">port</span><span class="o">:</span> <span class="nx">PORT</span>
<span class="p">});</span>

<span class="nx">server</span><span class="p">.</span><span class="nx">route</span><span class="p">({</span>
  <span class="nx">method</span><span class="o">:</span> <span class="s2">&quot;GET&quot;</span><span class="p">,</span>
  <span class="nx">path</span><span class="o">:</span> <span class="s2">&quot;/&quot;</span><span class="p">,</span>
  <span class="nx">handler</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">request</span><span class="p">,</span> <span class="nx">headers</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">request</span><span class="p">.</span><span class="nx">query</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">});</span>

<span class="kr">const</span> <span class="nx">startPromise</span> <span class="o">=</span> <span class="nx">async</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">try</span> <span class="p">{</span>
    <span class="nx">await</span> <span class="nx">server</span><span class="p">.</span><span class="nx">start</span><span class="p">();</span>
  <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">err</span><span class="p">);</span>
    <span class="nx">process</span><span class="p">.</span><span class="nx">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="sb">`Hapi running at: </span><span class="si">${</span><span class="nx">server</span><span class="p">.</span><span class="nx">info</span><span class="p">.</span><span class="nx">uri</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
<span class="p">};</span>

<span class="nx">startPromise</span><span class="p">();</span>
</pre></div>


<h2>5)&nbsp;restify</h2>
<p>Probably the least popular of the frameworks in this list. It strives to be a strict implementation of the <span class="caps">REST</span> architectural&nbsp;style.</p>
<div class="highlight"><pre><span></span><span class="kr">const</span> <span class="nx">restify</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;restify&quot;</span><span class="p">);</span>
<span class="kr">const</span> <span class="nx">PORT</span> <span class="o">=</span> <span class="mi">3000</span><span class="p">;</span>

<span class="kr">const</span> <span class="nx">server</span> <span class="o">=</span> <span class="nx">restify</span><span class="p">.</span><span class="nx">createServer</span><span class="p">();</span>
<span class="nx">server</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">restify</span><span class="p">.</span><span class="nx">plugins</span><span class="p">.</span><span class="nx">queryParser</span><span class="p">());</span>

<span class="nx">server</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">,</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">,</span> <span class="nx">next</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="nx">res</span><span class="p">.</span><span class="nx">json</span><span class="p">(</span><span class="nx">req</span><span class="p">.</span><span class="nx">query</span><span class="p">);</span>
<span class="p">});</span>

<span class="nx">server</span><span class="p">.</span><span class="nx">listen</span><span class="p">(</span><span class="nx">PORT</span><span class="p">,</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="sb">`Restify listening at port </span><span class="si">${</span><span class="nx">PORT</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
<span class="p">});</span>
</pre></div>


<h2>6)&nbsp;Koa</h2>
<p>Described as a <a href="https://koajs.com/">&#8220;next generation framework from the creators of Express&#8221;</a>, here&#8217;s&nbsp;Koa.</p>
<div class="highlight"><pre><span></span><span class="kr">const</span> <span class="nx">koa</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;koa&quot;</span><span class="p">);</span>
<span class="kr">const</span> <span class="nx">app</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">koa</span><span class="p">();</span>
<span class="kr">const</span> <span class="nx">PORT</span> <span class="o">=</span> <span class="mi">3000</span><span class="p">;</span>

<span class="nx">app</span><span class="p">.</span><span class="nx">callback</span><span class="p">(</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="sb">`Koa listening on port </span><span class="si">${</span><span class="nx">PORT</span><span class="si">}</span><span class="sb">...`</span><span class="p">));</span>

<span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">async</span> <span class="nx">ctx</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="nx">ctx</span><span class="p">.</span><span class="nx">set</span><span class="p">({</span> <span class="s2">&quot;content-type&quot;</span><span class="o">:</span> <span class="s2">&quot;application/json&quot;</span><span class="p">,</span> <span class="nx">status</span><span class="o">:</span> <span class="mi">200</span> <span class="p">});</span>
  <span class="nx">ctx</span><span class="p">.</span><span class="nx">body</span> <span class="o">=</span> <span class="nx">ctx</span><span class="p">.</span><span class="nx">request</span><span class="p">.</span><span class="nx">query</span><span class="p">;</span>
<span class="p">});</span>

<span class="nx">app</span><span class="p">.</span><span class="nx">listen</span><span class="p">(</span><span class="nx">PORT</span><span class="p">);</span>
</pre></div>


<p>From the little time I&#8217;ve spent with all these frameworks, I think I like the look of Koa the most. This was just a very quick look at making a barebones server in all these different packages. Each one has their own ecosystem and quirks, pros and cons. I recommend going through their documentation to see what they can really&nbsp;offer.</p>
<p>Next up, a selection of flavors from the server side of Python&nbsp;frameworks.</p>
  </div>
</div>
<div class="comments">
    <div id="disqus_thread"></div>
    <script type="text/javascript">
        var disqus_shortname = 'raulnegron';
        var disqus_title = 'Server-side JavaScript, available in 6&nbsp;flavors';
        (function () {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
      </div>

      <label for="sidebar-checkbox" class="sidebar-toggle"></label>

      <script>
        (function(document) {
          var i = 0;
          // snip empty header rows since markdown can't
          var rows = document.querySelectorAll('tr');
          for(i=0; i<rows.length; i++) {
            var ths = rows[i].querySelectorAll('th');
            var rowlen = rows[i].children.length;
            if (ths.length > 0 && ths.length === rowlen) {
              rows[i].remove();
            }
          }
        })(document);
      </script>

      <script>
        /* Lanyon & Poole are Copyright (c) 2014 Mark Otto. Adapted to Pelican 20141223 and extended a bit by @thomaswilley */
        (function(document) {
          var toggle = document.querySelector('.sidebar-toggle');
          var sidebar = document.querySelector('#sidebar');
          var checkbox = document.querySelector('#sidebar-checkbox');
          document.addEventListener('click', function(e) {
            var target = e.target;
            if(!checkbox.checked ||
            sidebar.contains(target) ||
            (target === checkbox || target === toggle)) return;
            checkbox.checked = false;
            }, false);
            })(document);
      </script>
     </div>
  </body>
</html>