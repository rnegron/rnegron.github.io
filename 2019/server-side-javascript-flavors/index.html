<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">

  <head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8" />

  
  <meta
    name="viewport"
    content="width=device-width, initial-scale=1.0, maximum-scale=1"
  />

  <title>
    
    Server-side JavaScript, available in 6 flavors
    
  </title>

  
  <script
    type="text/javascript"
    async
    src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"
  >
      MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [['$','$'], ['\\(','\\)']],
      displayMath: [['$$','$$']],
      processEscapes: true,
      processEnvironments: true,
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
      TeX: { equationNumbers: { autoNumber: "AMS" },
           extensions: ["AMSmath.js", "AMSsymbols.js"] }
    }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i = 0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });

        MathJax.Hub.Config({
          
          TeX: { equationNumbers: { autoNumber: "AMS" } }
        });
  </script>

  
  <link rel="stylesheet" href="/css/poole.css" />
  <link rel="stylesheet" href="/css/syntax.css" />
  <link rel="stylesheet" href="/css/lanyon.css" />
  <link rel="stylesheet" href="/css/styles.css" />
  <link
    rel="stylesheet"
    href="https://fonts.googleapis.com/css?family=PT+Serif:400,400italic,700|PT+Sans:400"
  />

  
  <link
    rel="apple-touch-icon-precomposed"
    sizes="144x144"
    href="/assets/apple-touch-icon-144-precomposed.png"
  />
  <link rel="shortcut icon" href="/assets/favicon.ico" />

  
  <link
    rel="alternate"
    type="application/rss+xml"
    title="RSS"
    href="/atom.xml"
  />
</head>


  <body>

    
<input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox">


<div class="sidebar" id="sidebar">
  <div class="sidebar-item">
    <div class="profile">
      <img src="/img/profile.png" />
    </div>
  </div>

  <nav class="sidebar-nav">
    <a class="sidebar-nav-item " href="/">main page</a>

    
    
      
        <a class="sidebar-nav-item " href="https://raulnegron.me/about/">about me</a>
      
    
      
        <a class="sidebar-nav-item " href="https://raulnegron.me/blog/">blog</a>
      
    
      
        <a class="sidebar-nav-item " href="https://raulnegron.me/projects/">open source projects</a>
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
<a class="sidebar-nav-item" href="https://github.com/rnegron" target="_blank">github</a>
<a class="sidebar-nav-item" href="https://www.linkedin.com/in/raulnegron/" target="_blank">linkedin</a>
</nav>

<div class="sidebar-item">
  <p>Site written in <a href="https://daringfireball.net/projects/markdown/">Markdown</a>, generated by <a
      href="https://gohugo.io">Hugo</a>, hosted on <a href="https://pages.github.com/">Github
      Pages</a> and registered using <a href="https://aws.amazon.com/route53/">Route 53</a>.</p>
  <p class="tiny-note">
    <a class="muted" href="https://github.com/thomaswilley/pelicanyan">theme: modified hugo-lanyon</a>
  </p>
</div>

<div class="sidebar-item">
  <p>&copy; 2019. All rights reserved.</p>
</div>
</div>


    
    <div class="wrap">
      <div class="masthead">
        <div class="container">
          <h3 class="masthead-title">
            <a href="/" title="Home"></a>
            <small></small>
          </h3>
        </div>
      </div>

      <div class="container content">


<div class="post">
  <h1 class="post-title">Server-side JavaScript, available in 6 flavors</h1>
  <span class="post-date">January 26, 2019</span>
  <p>I've been reading up on JavaScript these past few months. I feel like there used to be a stigma against the language during my time at university, and maybe there still is. I dug up and read a book I once bought called <a href="http://shop.oreilly.com/product/9780596517748.do">JavaScript: The Good Parts</a> by Douglas Crockford. It's outdated now, but I used to joke that if &ldquo;The Good Parts&rdquo; could be described in 172 pages&hellip; Well, suffice it to say, I was not very encouraged.</p>
<p>Well, I've come around. <a href="https://github.com/mbeaudru/modern-js-cheatsheet">Modern JavaScript</a> is fun to write and, being a web-first language, it entices you to think about problems in a different way from other languages I've tried. After going through some <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/A_re-introduction_to_JavaScript">basic language training</a>, it's time to see how to set up a simple web server, JavaScript style.</p>
<h2 id="a-selection-of-flavors-to-choose-from">A selection of flavors to choose from</h2>
<p>Once you start researching your options, you may feel the onset of analysis paralysis. There are a lot of different packages and projects to choose from. I thought it would be fun to write a simple echo server using a few of them, as an excuse to go through their tutorial and docs.</p>
<h2 id="setup">Setup</h2>
<p>Simple as pie. For sending requests, I like to use <a href="https://httpie.org/">HTTPie</a>. We'll use it to easily send some query parameters through <code>localhost</code> on port 3000. I should mention that I am running NodeJS v11.7.0 and HTTPie v1.0.2.</p>
<h2 id="1-nodejs-core">1) NodeJS Core</h2>
<p>First up, vanilla <a href="https://nodejs.org/">NodeJS</a> style.</p>
<div class="highlight"><pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="kr">const</span> <span class="nx">http</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&#34;http&#34;</span><span class="p">)</span><span class="p">;</span>
<span class="kr">const</span> <span class="nx">url</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&#34;url&#34;</span><span class="p">)</span><span class="p">;</span>

<span class="kr">const</span> <span class="nx">PORT</span> <span class="o">=</span> <span class="mi">3000</span><span class="p">;</span>

<span class="kr">const</span> <span class="nx">server</span> <span class="o">=</span> <span class="nx">http</span><span class="p">.</span><span class="nx">createServer</span><span class="p">(</span><span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="nx">res</span><span class="p">.</span><span class="nx">writeHead</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="p">{</span> <span class="s2">&#34;content-type&#34;</span><span class="o">:</span> <span class="s2">&#34;application/json&#34;</span> <span class="p">}</span><span class="p">)</span><span class="p">;</span>

  <span class="kr">const</span> <span class="nx">query</span> <span class="o">=</span> <span class="nx">url</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">req</span><span class="p">.</span><span class="nx">url</span><span class="p">,</span> <span class="p">(</span><span class="nx">parseQueryString</span> <span class="o">=</span> <span class="kc">true</span><span class="p">)</span><span class="p">)</span><span class="p">.</span><span class="nx">query</span><span class="p">;</span>

  <span class="nx">res</span><span class="p">.</span><span class="nx">end</span><span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">query</span><span class="p">)</span><span class="p">)</span><span class="p">;</span>
<span class="p">}</span><span class="p">)</span><span class="p">;</span>

<span class="nx">server</span><span class="p">.</span><span class="nx">listen</span><span class="p">(</span><span class="nx">PORT</span><span class="p">,</span> <span class="nx">err</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="k">throw</span> <span class="nx">err</span><span class="p">;</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="sb">`</span><span class="sb">Now listening at port </span><span class="si">${</span><span class="nx">PORT</span><span class="si">}</span><span class="sb">...</span><span class="sb">`</span><span class="p">)</span><span class="p">;</span>
<span class="p">}</span><span class="p">)</span><span class="p">;</span>
</code></pre></div><p>Testing it out with <code>http :3000 user==1</code>, we get the following response:</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">HTTP/1.1 <span class="m">200</span> OK
Connection: keep-alive
Content-Type: application/json
Date: Sat, <span class="m">26</span> Jan <span class="m">2019</span> 22:49:34 GMT
Transfer-Encoding: chunked

<span class="o">{</span>
    <span class="s2">&#34;user&#34;</span>: <span class="s2">&#34;1&#34;</span>
<span class="o">}</span>
</code></pre></div><p>A nifty, if plain, echo server. We should expect the response from all the servers in this blog post to have the <code>content-type</code> header set to &ldquo;application/json&rdquo; and the status set at 200, so I will omit the rest of their responses.</p>
<p>Even though the code is quite simple, we still had to work for that echo response. Other packages highlighted in this post will automatically parse the query string from the URL, but we didn't have that luxury here. The response also had to be manually JSON-stringified. Diving a bit deeper (down the prototype chain), we find that our server, from <code>http.createServer()</code>, is an <a href="https://nodejs.org/api/events.html#events_class_eventemitter">EventEmitter</a>. It's been instructed to listen for request events at port 3000. The <code>req</code> and <code>res</code> streams (notice there are two&hellip;) represent the client side request and the server side response, respectively. Moving on to the rest of the server-side flavors&hellip;</p>
<h2 id="2-nodejs-core-the-sequel">2) NodeJS Core: The Sequel</h2>
<p>But before that, did you know there is a core NodeJS module called <a href="https://nodejs.org/api/http2.html">http2</a>? Actually, back it up, did you know there is a <a href="https://tools.ietf.org/html/rfc7540">version 2 of HTTP</a>?! In any case, this module is a stable part of NodeJS now, so I believe it should get it's own spot.</p>
<div class="highlight"><pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="kr">const</span> <span class="nx">http2</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&#34;http2&#34;</span><span class="p">)</span><span class="p">;</span>
<span class="kr">const</span> <span class="nx">server</span> <span class="o">=</span> <span class="nx">http2</span><span class="p">.</span><span class="nx">createServer</span><span class="p">(</span><span class="p">)</span><span class="p">;</span>
<span class="kr">const</span> <span class="nx">url</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&#34;url&#34;</span><span class="p">)</span><span class="p">;</span>

<span class="kr">const</span> <span class="nx">PORT</span> <span class="o">=</span> <span class="mi">3000</span><span class="p">;</span>

<span class="nx">server</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">&#34;error&#34;</span><span class="p">,</span> <span class="nx">err</span> <span class="p">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span><span class="p">)</span><span class="p">;</span>

<span class="nx">server</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">&#34;stream&#34;</span><span class="p">,</span> <span class="p">(</span><span class="nx">stream</span><span class="p">,</span> <span class="nx">headers</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="kr">const</span> <span class="nx">response</span> <span class="o">=</span> <span class="nx">url</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">headers</span><span class="p">[</span><span class="s2">&#34;:path&#34;</span><span class="p">]</span><span class="p">,</span> <span class="kc">true</span><span class="p">)</span><span class="p">.</span><span class="nx">query</span><span class="p">;</span>

  <span class="nx">stream</span><span class="p">.</span><span class="nx">respond</span><span class="p">(</span><span class="p">{</span> <span class="s2">&#34;:status&#34;</span><span class="o">:</span> <span class="mi">200</span><span class="p">,</span> <span class="s2">&#34;content-type&#34;</span><span class="o">:</span> <span class="s2">&#34;application/json&#34;</span> <span class="p">}</span><span class="p">)</span><span class="p">;</span>

  <span class="nx">stream</span><span class="p">.</span><span class="nx">end</span><span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">response</span><span class="p">)</span><span class="p">)</span><span class="p">;</span>
<span class="p">}</span><span class="p">)</span><span class="p">;</span>

<span class="nx">server</span><span class="p">.</span><span class="nx">listen</span><span class="p">(</span><span class="nx">PORT</span><span class="p">)</span><span class="p">;</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="sb">`</span><span class="sb">HTTP2 Server now listening at port </span><span class="si">${</span><span class="nx">PORT</span><span class="si">}</span><span class="sb">...</span><span class="sb">`</span><span class="p">)</span><span class="p">;</span>
</code></pre></div><p>We're in it now. Instead of two separate streams, the server now responds to the <code>stream</code> event and provides a duplex stream. We obtain the query parameters via the <code>headers</code> object, and parse it similarly to how it was done using the original <code>http</code> example.</p>
<p>By the way, the above code won't work on browsers&hellip; While HTTP/2 <a href="https://http2.github.io/faq/#does-http2-require-encryption">does not</a> enforce encryption, modern browsers seem to have conspired to enforce it. There exists an <code>http2.createSecureServer</code> which can work with browsers. But without setting up a secure server, how will we (taste) test this flavor? Even HTTPie has trouble with it! I tried the experimental <a href="https://github.com/httpie/httpie-http2">HTTP/2</a> plugin, but could not get it to work.</p>
<p>Let's roll up our sleeves and write a basic HTTP/2 client in Node to get this example to work.</p>
<div class="highlight"><pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="kr">const</span> <span class="nx">http2</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&#34;http2&#34;</span><span class="p">)</span><span class="p">;</span>
<span class="kr">const</span> <span class="nx">PORT</span> <span class="o">=</span> <span class="mi">3000</span><span class="p">;</span>

<span class="kr">const</span> <span class="nx">client</span> <span class="o">=</span> <span class="nx">http2</span><span class="p">.</span><span class="nx">connect</span><span class="p">(</span><span class="sb">`</span><span class="sb">http://localhost:</span><span class="si">${</span><span class="nx">PORT</span><span class="si">}</span><span class="sb">`</span><span class="p">)</span><span class="p">;</span>

<span class="nx">client</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">&#34;error&#34;</span><span class="p">,</span> <span class="nx">err</span> <span class="p">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span><span class="p">)</span><span class="p">;</span>

<span class="kr">const</span> <span class="nx">req</span> <span class="o">=</span> <span class="nx">client</span><span class="p">.</span><span class="nx">request</span><span class="p">(</span><span class="p">{</span>
  <span class="s2">&#34;:path&#34;</span><span class="o">:</span> <span class="s2">&#34;/?user=1&#34;</span>
<span class="p">}</span><span class="p">)</span><span class="p">;</span>

<span class="nx">req</span><span class="p">.</span><span class="nx">setEncoding</span><span class="p">(</span><span class="s2">&#34;utf8&#34;</span><span class="p">)</span><span class="p">;</span>

<span class="kd">let</span> <span class="nx">data</span> <span class="o">=</span> <span class="p">[</span><span class="p">]</span><span class="p">;</span>

<span class="nx">req</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">&#34;data&#34;</span><span class="p">,</span> <span class="nx">chunk</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="nx">data</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">chunk</span><span class="p">)</span><span class="p">;</span>
<span class="p">}</span><span class="p">)</span><span class="p">;</span>

<span class="nx">req</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">&#34;end&#34;</span><span class="p">,</span> <span class="p">(</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="p">)</span><span class="p">)</span><span class="p">;</span>
  <span class="nx">client</span><span class="p">.</span><span class="nx">close</span><span class="p">(</span><span class="p">)</span><span class="p">;</span>
<span class="p">}</span><span class="p">)</span><span class="p">;</span>

<span class="nx">req</span><span class="p">.</span><span class="nx">end</span><span class="p">(</span><span class="p">)</span><span class="p">;</span>
</code></pre></div><p>It works! This flavor we really had to work for, but it was worth it in the end.</p>
<p>(P.S. If you noticed the colon to the left of <code>&quot;path&quot;</code> and <code>&quot;status&quot;</code> in the code and don't know what they are, may I introduce you to: <a href="https://http2.github.io/http2-spec/#rfc.section.8.1.2.1">pseudo headers</a>)</p>
<h2 id="3-express">3) Express</h2>
<p>Here we have the <a href="https://expressjs.com/">Express</a> framework, probably the most popular of the NodeJS backend libraries.</p>
<div class="highlight"><pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="kr">const</span> <span class="nx">express</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&#34;express&#34;</span><span class="p">)</span><span class="p">;</span>
<span class="kr">const</span> <span class="nx">app</span> <span class="o">=</span> <span class="nx">express</span><span class="p">(</span><span class="p">)</span><span class="p">;</span>
<span class="kr">const</span> <span class="nx">PORT</span> <span class="o">=</span> <span class="mi">3000</span><span class="p">;</span>

<span class="nx">app</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&#34;/&#34;</span><span class="p">,</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="nx">res</span><span class="p">.</span><span class="nx">json</span><span class="p">(</span><span class="nx">req</span><span class="p">.</span><span class="nx">query</span><span class="p">)</span><span class="p">;</span>
<span class="p">}</span><span class="p">)</span><span class="p">;</span>

<span class="nx">app</span><span class="p">.</span><span class="nx">listen</span><span class="p">(</span><span class="nx">PORT</span><span class="p">,</span> <span class="p">(</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="sb">`</span><span class="sb">Express listening on port </span><span class="si">${</span><span class="nx">PORT</span><span class="si">}</span><span class="sb">...</span><span class="sb">`</span><span class="p">)</span>
<span class="p">}</span><span class="p">)</span><span class="p">;</span>
</code></pre></div><p>That <code>app</code> object has access to a lot more than what is seen here, including a powerful method chaining concept called <a href="https://expressjs.com/en/guide/using-middleware.html">middleware</a>.</p>
<h2 id="4-hapijs">4) Hapi.js</h2>
<p>I had never heard about Hapi before researching this topic. Here's how it looks.</p>
<div class="highlight"><pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="kr">const</span> <span class="nx">hapi</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&#34;hapi&#34;</span><span class="p">)</span><span class="p">;</span>
<span class="kr">const</span> <span class="nx">PORT</span> <span class="o">=</span> <span class="mi">3000</span><span class="p">;</span>

<span class="kr">const</span> <span class="nx">server</span> <span class="o">=</span> <span class="nx">hapi</span><span class="p">.</span><span class="nx">server</span><span class="p">(</span><span class="p">{</span>
  <span class="nx">host</span><span class="o">:</span> <span class="s2">&#34;localhost&#34;</span><span class="p">,</span>
  <span class="nx">port</span><span class="o">:</span> <span class="nx">PORT</span>
<span class="p">}</span><span class="p">)</span><span class="p">;</span>

<span class="nx">server</span><span class="p">.</span><span class="nx">route</span><span class="p">(</span><span class="p">{</span>
  <span class="nx">method</span><span class="o">:</span> <span class="s2">&#34;GET&#34;</span><span class="p">,</span>
  <span class="nx">path</span><span class="o">:</span> <span class="s2">&#34;/&#34;</span><span class="p">,</span>
  <span class="nx">handler</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">request</span><span class="p">,</span> <span class="nx">headers</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">request</span><span class="p">.</span><span class="nx">query</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span><span class="p">)</span><span class="p">;</span>

<span class="kr">const</span> <span class="nx">startPromise</span> <span class="o">=</span> <span class="nx">async</span> <span class="kd">function</span><span class="p">(</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">try</span> <span class="p">{</span>
    <span class="nx">await</span> <span class="nx">server</span><span class="p">.</span><span class="nx">start</span><span class="p">(</span><span class="p">)</span><span class="p">;</span>
  <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span><span class="p">;</span>
    <span class="nx">process</span><span class="p">.</span><span class="nx">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="sb">`</span><span class="sb">Hapi running at: </span><span class="si">${</span><span class="nx">server</span><span class="p">.</span><span class="nx">info</span><span class="p">.</span><span class="nx">uri</span><span class="si">}</span><span class="sb">`</span><span class="p">)</span><span class="p">;</span>
<span class="p">}</span><span class="p">;</span>

<span class="nx">startPromise</span><span class="p">(</span><span class="p">)</span><span class="p">;</span>
</code></pre></div><h2 id="5-restify">5) restify</h2>
<p>Probably the least popular of the frameworks in this list. It strives to be a strict implementation of the REST architectural style.</p>
<div class="highlight"><pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="kr">const</span> <span class="nx">restify</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&#34;restify&#34;</span><span class="p">)</span><span class="p">;</span>
<span class="kr">const</span> <span class="nx">PORT</span> <span class="o">=</span> <span class="mi">3000</span><span class="p">;</span>

<span class="kr">const</span> <span class="nx">server</span> <span class="o">=</span> <span class="nx">restify</span><span class="p">.</span><span class="nx">createServer</span><span class="p">(</span><span class="p">)</span><span class="p">;</span>
<span class="nx">server</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">restify</span><span class="p">.</span><span class="nx">plugins</span><span class="p">.</span><span class="nx">queryParser</span><span class="p">(</span><span class="p">)</span><span class="p">)</span><span class="p">;</span>

<span class="nx">server</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&#34;/&#34;</span><span class="p">,</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">,</span> <span class="nx">next</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="nx">res</span><span class="p">.</span><span class="nx">json</span><span class="p">(</span><span class="nx">req</span><span class="p">.</span><span class="nx">query</span><span class="p">)</span><span class="p">;</span>
<span class="p">}</span><span class="p">)</span><span class="p">;</span>

<span class="nx">server</span><span class="p">.</span><span class="nx">listen</span><span class="p">(</span><span class="nx">PORT</span><span class="p">,</span> <span class="p">(</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="sb">`</span><span class="sb">Restify listening at port </span><span class="si">${</span><span class="nx">PORT</span><span class="si">}</span><span class="sb">`</span><span class="p">)</span><span class="p">;</span>
<span class="p">}</span><span class="p">)</span><span class="p">;</span>
</code></pre></div><h2 id="6-koa">6) Koa</h2>
<p>Described as a <a href="https://koajs.com/">&ldquo;next generation framework from the creators of Express&rdquo;</a>, here's Koa.</p>
<div class="highlight"><pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="kr">const</span> <span class="nx">koa</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&#34;koa&#34;</span><span class="p">)</span><span class="p">;</span>
<span class="kr">const</span> <span class="nx">app</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">koa</span><span class="p">(</span><span class="p">)</span><span class="p">;</span>
<span class="kr">const</span> <span class="nx">PORT</span> <span class="o">=</span> <span class="mi">3000</span><span class="p">;</span>

<span class="nx">app</span><span class="p">.</span><span class="nx">callback</span><span class="p">(</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="sb">`</span><span class="sb">Koa listening on port </span><span class="si">${</span><span class="nx">PORT</span><span class="si">}</span><span class="sb">...</span><span class="sb">`</span><span class="p">)</span><span class="p">)</span><span class="p">;</span>

<span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">async</span> <span class="nx">ctx</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="nx">ctx</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="p">{</span> <span class="s2">&#34;content-type&#34;</span><span class="o">:</span> <span class="s2">&#34;application/json&#34;</span><span class="p">,</span> <span class="nx">status</span><span class="o">:</span> <span class="mi">200</span> <span class="p">}</span><span class="p">)</span><span class="p">;</span>
  <span class="nx">ctx</span><span class="p">.</span><span class="nx">body</span> <span class="o">=</span> <span class="nx">ctx</span><span class="p">.</span><span class="nx">request</span><span class="p">.</span><span class="nx">query</span><span class="p">;</span>
<span class="p">}</span><span class="p">)</span><span class="p">;</span>

<span class="nx">app</span><span class="p">.</span><span class="nx">listen</span><span class="p">(</span><span class="nx">PORT</span><span class="p">)</span><span class="p">;</span>
</code></pre></div><p>From the little time I've spent with all these frameworks, I think I like the look of Koa the most. This was just a very quick look at making a barebones server in all these different packages. Each one has their own ecosystem and quirks, pros and cons. I recommend going through their documentation to see what they can really offer.</p>
<p>Next up, a selection of flavors from the server side of Python frameworks.</p>

</div>

      </div>
    </div>

    <label for="sidebar-checkbox" class="sidebar-toggle"></label>

  </body>
</html>

